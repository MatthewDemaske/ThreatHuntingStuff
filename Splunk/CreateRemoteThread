sourcetype="*WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode=8 (SourceImage=*excel.exe OR SourceImage=*winword.exe OR SourceImage=*powerpnt.exe OR SourceImage=*msaccess.exe OR SourceImage=*visio.exe OR SourceImage=*ois.exe OR SourceImage=*infopath.exe OR SourceImage=*mspub.exe OR SourceImage=*vpreview.exe OR SourceImage=*pptview.exe OR SourceImage=*wordpad.exe OR SourceImage=*outlook.exe OR SourceImage=*acrord32.exe OR SourceImage=*acrobat.exe OR SourceImage=*PDFPlus.exe OR SourceImage=*java.exe OR SourceImage=*javaws.exe OR SourceImage=*javaw.exe OR SourceImage=*cmd.exe OR SourceImage=*powershell.exe OR SourceImage=*powershell_ise.exe OR SourceImage=*csc.exe OR SourceImage=*wscript.exe OR SourceImage=*jsc.exe OR SourceImage=*jscript.exe OR SourceImage=*vbc.exe OR SourceImage=*cscript.exe OR SourceImage=*verclsid.exe OR SourceImage=*mshta.exe OR SourceImage=*rundll32.exe OR SourceImage=*regsvr32.exe OR SourceImage=*regasm.exe OR SourceImage=*regsvcs.exe OR SourceImage=*installutil.exe OR SourceImage=*msbuild.exe) OR (TargetImage=*explorer.exe OR TargetImage=*lsass.exe OR TargetImage=*services.exe) OR (StartAddress=*0B80) OR ((SourceImage="C:\\Windows\\System32\\cscript.exe" OR SourceImage="C:\\Windows\\System32\\wscript.exe" OR SourceImage="C:\\Windows\\System32\\mshta.exe") TargetImage="C:\\Windows\\SysWOW64\\*")
|fields Computer, StartFunction, SourceImage, StartModule, TargetImage
|eval StartFunction=if(isnull(StartFunction),"missing",StartFunction) 
|eval StartModule=if(isnull(StartModule),"missing",StartModule)
|eval TargetImage=if(isnull(TargetImage),"missing",TargetImage)
|eval SourceImage=if(isnull(SourceImage),"missing",SourceImage)
